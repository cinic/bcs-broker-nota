function hoverMarker(t){var o=markers[t],e=o.placemark;e.options.set("iconContentLayout",ymaps.templateLayoutFactory.createClass('<span class="marker active">'+t+"</span>")),$(".point[data-point="+t+"] .marker").addClass("hovered")}function blurMarker(t){var o=markers[t],e=o.placemark;o.active||e.options.set("iconContentLayout",ymaps.templateLayoutFactory.createClass('<span class="marker">'+t+"</span>")),$(".point[data-point="+t+"] .marker").removeClass("hovered")}function openRoute(){closeAllPointDetails(),$(".route").show(),bindTogglebox(),routing=!0}function closeRoute(){removeRoute(),$(".route").hide(),routing=!1}function clearRoutes(){$(".route .route-points input").val("")}function setRoutePoint(t,o,e){1==e?($("#pointA").val(o),$("#pointA-coord").val(t)):($("#pointB").val(o),$("#pointB-coord").val(t)),$("#pointA-coord").val().length&&$("#pointB-coord").val().length&&setRoute()}function removeRoute(){multiRoute&&contactMap.geoObjects.remove(multiRoute),multiRoute=!1}function setRoute(){removeRoute();var t=$("#routingMode").val(),o=$("#avoidTraffic").is(":checked"),e=$("#pointA-coord").val().length?$("#pointA-coord").val():$("#pointA").val(),n=$("#pointB-coord").val().length?$("#pointB-coord").val():$("#pointB").val();multiRoute=new ymaps.multiRouter.MultiRoute({referencePoints:[e,n],params:{routingMode:t,avoidTrafficJams:o}},{routeStrokeWidth:1,routeActiveStrokeWidth:4,routeStrokeColor:"#ffffff",routeActiveStrokeColor:"#122f5b",wayPointStartIconLayout:"default#image",wayPointStartIconImageHref:"/content/images/map-marker.png",wayPointStartContentSize:[10,10],wayPointStartIconImageSize:[27,36],wayPointStartIconImageOffset:[-13,-36],wayPointFinishIconLayout:"default#image",wayPointFinishIconImageHref:"/content/images/map-marker.png",wayPointFinishContentSize:[10,10],wayPointFinishIconImageSize:[27,36],wayPointFinishIconImageOffset:[-13,-36]}),contactMap.geoObjects.add(multiRoute)}function openPointDetails(t){if($(".point-detail[data-point="+t+"]").is(":visible"))return!1;removeRoute(),closeAllPointDetails(),closeRoute(),$(".point-detail[data-point="+t+"]").show();var o=markers[t];o.active=!0,markers[t]=o,hoverMarker(t)}function closePointDetails(t){$(".point-detail[data-point="+t+"]").hide();var o=markers[t];o.active=!1,markers[t]=o,blurMarker(t)}function closeAllPointDetails(){$(".point-detail:visible").each(function(){var t=parseInt($(this).attr("data-point"));closePointDetails(t)})}var markers=[],routing=!1,contactMap,multiRoute=!1;$(function(){$(".point-detail .close").click(function(){var t=$(this).parent(),o=parseInt(t.attr("data-point"));return closePointDetails(o),$(".points").show(),!1}),$(".route .close").on("click",function(){return $(".points").show(),closeRoute(),!1}),$(".contact-map .points a").on("mouseenter",function(){var t=parseInt($(this).attr("data-point"));hoverMarker(t)}),$(".contact-map .points a").on("mouseleave",function(){var t=parseInt($(this).attr("data-point"));blurMarker(t)}),$(".contact-map .points a").on("click",function(){parseInt($(this).attr("data-point"));return $(this).next().slideToggle("down"),!1}),$("#contact-map")&&$("#contact-map").length&&ymaps.ready(function(){contactMap=new ymaps.Map("contact-map",{center:[center_latitude,center_longitude],zoom:11,controls:[],behaviors:["drag"]}),contactMap.events.add("click",function(t){var o=t.get("coords");routing&&ymaps.geocode(o,{kind:"house",results:1}).then(function(t){var e=t.geoObjects.get(0),n=e.properties.get("name");$("#pointA").val().length?$("#pointB").val().length||setRoutePoint(o,n,2):setRoutePoint(o,n,1)})});for(var t in contactPoints){var o=contactPoints[t],e=new ymaps.Placemark(o,{},{iconLayout:"default#imageWithContent",iconImageHref:"/content/images/spacer.png",iconImageSize:[44,44],iconImageOffset:[-22,-22],iconContentSize:[44,44],pointNum:t,iconContentLayout:ymaps.templateLayoutFactory.createClass('<span class="marker">'+t+"</span>")});e.events.add("mouseenter",function(t){var o=t.get("target").options.get("pointNum");hoverMarker(o)}).add("mouseleave",function(t){var o=t.get("target").options.get("pointNum");blurMarker(o)}).add("click",function(t){var o=t.get("target").options.get("pointNum");openPointDetails(o)}),contactMap.geoObjects.add(e),markers[t]={placemark:e,active:!1}}$("#zoom-in").click(function(){var t=contactMap.getZoom();return t>=17?!1:void contactMap.setZoom(t+1,{duration:200})}),$("#zoom-out").click(function(){var t=contactMap.getZoom();return 1>=t?!1:void contactMap.setZoom(t-1,{duration:200})})}),$("#points-change").on("click",function(){var t=$("#pointA").val(),o=$("#pointA-coord").val();return $("#pointA").val($("#pointB").val()),$("#pointA-coord").val($("#pointB-coord").val()),$("#pointB").val(t),$("#pointB-coord").val(o),setRoute(),!1}),$(".route .btn").click(function(){return setRoute(),!1}),$("#routingMode").on("change",function(){setRoute()}),$("#avoidTraffic").on("change",function(){setRoute()}),$("#pointA").on("change",function(){$("#pointA-coord").val("")}),$("#pointB").on("change",function(){$("#pointB-coord").val("")})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRhY3RzLmpzIl0sIm5hbWVzIjpbImhvdmVyTWFya2VyIiwibnVtIiwibWFya2VyIiwibWFya2VycyIsInBsYWNlbWFyayIsIm9wdGlvbnMiLCJzZXQiLCJ5bWFwcyIsInRlbXBsYXRlTGF5b3V0RmFjdG9yeSIsImNyZWF0ZUNsYXNzIiwiJCIsImFkZENsYXNzIiwiYmx1ck1hcmtlciIsImFjdGl2ZSIsInJlbW92ZUNsYXNzIiwib3BlblJvdXRlIiwiY2xvc2VBbGxQb2ludERldGFpbHMiLCJzaG93IiwiYmluZFRvZ2dsZWJveCIsInJvdXRpbmciLCJjbG9zZVJvdXRlIiwicmVtb3ZlUm91dGUiLCJoaWRlIiwiY2xlYXJSb3V0ZXMiLCJ2YWwiLCJzZXRSb3V0ZVBvaW50IiwiY29vcmQiLCJuYW1lIiwibiIsImxlbmd0aCIsInNldFJvdXRlIiwibXVsdGlSb3V0ZSIsImNvbnRhY3RNYXAiLCJnZW9PYmplY3RzIiwicmVtb3ZlIiwibW9kZSIsImF2b2lkVHJhZmZpYyIsImlzIiwicG9pbnRBIiwicG9pbnRCIiwibXVsdGlSb3V0ZXIiLCJNdWx0aVJvdXRlIiwicmVmZXJlbmNlUG9pbnRzIiwicGFyYW1zIiwicm91dGluZ01vZGUiLCJhdm9pZFRyYWZmaWNKYW1zIiwicm91dGVTdHJva2VXaWR0aCIsInJvdXRlQWN0aXZlU3Ryb2tlV2lkdGgiLCJyb3V0ZVN0cm9rZUNvbG9yIiwicm91dGVBY3RpdmVTdHJva2VDb2xvciIsIndheVBvaW50U3RhcnRJY29uTGF5b3V0Iiwid2F5UG9pbnRTdGFydEljb25JbWFnZUhyZWYiLCJ3YXlQb2ludFN0YXJ0Q29udGVudFNpemUiLCJ3YXlQb2ludFN0YXJ0SWNvbkltYWdlU2l6ZSIsIndheVBvaW50U3RhcnRJY29uSW1hZ2VPZmZzZXQiLCJ3YXlQb2ludEZpbmlzaEljb25MYXlvdXQiLCJ3YXlQb2ludEZpbmlzaEljb25JbWFnZUhyZWYiLCJ3YXlQb2ludEZpbmlzaENvbnRlbnRTaXplIiwid2F5UG9pbnRGaW5pc2hJY29uSW1hZ2VTaXplIiwid2F5UG9pbnRGaW5pc2hJY29uSW1hZ2VPZmZzZXQiLCJhZGQiLCJvcGVuUG9pbnREZXRhaWxzIiwiY2xvc2VQb2ludERldGFpbHMiLCJlYWNoIiwicGFyc2VJbnQiLCJ0aGlzIiwiYXR0ciIsImNsaWNrIiwicG9pbnQiLCJwYXJlbnQiLCJvbiIsIm5leHQiLCJzbGlkZVRvZ2dsZSIsInJlYWR5IiwiTWFwIiwiY2VudGVyIiwiY2VudGVyX2xhdGl0dWRlIiwiY2VudGVyX2xvbmdpdHVkZSIsInpvb20iLCJjb250cm9scyIsImJlaGF2aW9ycyIsImV2ZW50cyIsImUiLCJjb29yZHMiLCJnZXQiLCJnZW9jb2RlIiwia2luZCIsInJlc3VsdHMiLCJ0aGVuIiwicmVzIiwiZmlyc3RHZW9PYmplY3QiLCJwcm9wZXJ0aWVzIiwiaiIsImNvbnRhY3RQb2ludHMiLCJQbGFjZW1hcmsiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJpY29uQ29udGVudFNpemUiLCJwb2ludE51bSIsImljb25Db250ZW50TGF5b3V0IiwiZ2V0Wm9vbSIsInNldFpvb20iLCJkdXJhdGlvbiIsInBvaW50QV9jb29yZCJdLCJtYXBwaW5ncyI6IkFBSUEsUUFBU0EsYUFBWUMsR0FFakIsR0FBSUMsR0FBU0MsUUFBUUYsR0FDakJHLEVBQVlGLEVBQU9FLFNBQ3ZCQSxHQUFVQyxRQUFRQyxJQUFJLG9CQUFxQkMsTUFBTUMsc0JBQXNCQyxZQUFZLCtCQUErQlIsRUFBSSxZQUN0SFMsRUFBRSxxQkFBcUJULEVBQUksYUFBYVUsU0FBUyxXQUVyRCxRQUFTQyxZQUFXWCxHQUVoQixHQUFJQyxHQUFTQyxRQUFRRixHQUNqQkcsRUFBWUYsRUFBT0UsU0FDbEJGLEdBQU9XLFFBQ1JULEVBQVVDLFFBQVFDLElBQUksb0JBQXFCQyxNQUFNQyxzQkFBc0JDLFlBQVksd0JBQXdCUixFQUFJLFlBQ25IUyxFQUFFLHFCQUFxQlQsRUFBSSxhQUFhYSxZQUFZLFdB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QUFFLGlCQUFpQmMsSUFBSSIsImZpbGUiOiJjb250YWN0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBtYXJrZXJzID0gW107XG52YXIgcm91dGluZyA9IGZhbHNlO1xudmFyIGNvbnRhY3RNYXA7XG5cbmZ1bmN0aW9uIGhvdmVyTWFya2VyKG51bSlcbntcbiAgICB2YXIgbWFya2VyID0gbWFya2Vyc1tudW1dO1xuICAgIHZhciBwbGFjZW1hcmsgPSBtYXJrZXIucGxhY2VtYXJrO1xuICAgIHBsYWNlbWFyay5vcHRpb25zLnNldCgnaWNvbkNvbnRlbnRMYXlvdXQnLCB5bWFwcy50ZW1wbGF0ZUxheW91dEZhY3RvcnkuY3JlYXRlQ2xhc3MoJzxzcGFuIGNsYXNzPVwibWFya2VyIGFjdGl2ZVwiPicrbnVtKyc8L3NwYW4+JykpO1xuICAgICQoJy5wb2ludFtkYXRhLXBvaW50PScrbnVtKyddIC5tYXJrZXInKS5hZGRDbGFzcygnaG92ZXJlZCcpO1xufVxuZnVuY3Rpb24gYmx1ck1hcmtlcihudW0pXG57XG4gICAgdmFyIG1hcmtlciA9IG1hcmtlcnNbbnVtXTtcbiAgICB2YXIgcGxhY2VtYXJrID0gbWFya2VyLnBsYWNlbWFyaztcbiAgICBpZiAoIW1hcmtlci5hY3RpdmUpXG4gICAgICAgIHBsYWNlbWFyay5vcHRpb25zLnNldCgnaWNvbkNvbnRlbnRMYXlvdXQnLCB5bWFwcy50ZW1wbGF0ZUxheW91dEZhY3RvcnkuY3JlYXRlQ2xhc3MoJzxzcGFuIGNsYXNzPVwibWFya2VyXCI+JytudW0rJzwvc3Bhbj4nKSk7XG4gICAgJCgnLnBvaW50W2RhdGEtcG9pbnQ9JytudW0rJ10gLm1hcmtlcicpLnJlbW92ZUNsYXNzKCdob3ZlcmVkJyk7XG59XG5cbmZ1bmN0aW9uIG9wZW5Sb3V0ZSgpXG57XG4gICAgY2xvc2VBbGxQb2ludERldGFpbHMoKTtcbiAgICAvLyQoJy5tYXAtcm91dGUtbGluaycpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAkKCcucm91dGUnKS5zaG93KCk7XG4gICAgYmluZFRvZ2dsZWJveCgpO1xuICAgIHJvdXRpbmcgPSB0cnVlO1xufVxuXG5mdW5jdGlvbiBjbG9zZVJvdXRlKClcbntcbiAgICByZW1vdmVSb3V0ZSgpO1xuICAgIC8vJCgnLm1hcC1yb3V0ZS1saW5rJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICQoJy5yb3V0ZScpLmhpZGUoKTtcbiAgICByb3V0aW5nID0gZmFsc2U7XG59XG5mdW5jdGlvbiBjbGVhclJvdXRlcygpXG57XG4gICAgJCgnLnJvdXRlIC5yb3V0ZS1wb2ludHMgaW5wdXQnKS52YWwoJycpO1xufVxuZnVuY3Rpb24gc2V0Um91dGVQb2ludChjb29yZCwgbmFtZSwgbilcbntcbiAgICBpZiAobiA9PSAxKVxuICAgIHtcbiAgICAgICAgJCgnI3BvaW50QScpLnZhbChuYW1lKTtcbiAgICAgICAgJCgnI3BvaW50QS1jb29yZCcpLnZhbChjb29yZCk7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgICQoJyNwb2ludEInKS52YWwobmFtZSk7XG4gICAgICAgICQoJyNwb2ludEItY29vcmQnKS52YWwoY29vcmQpO1xuICAgIH1cblxuICAgIGlmICgkKCcjcG9pbnRBLWNvb3JkJykudmFsKCkubGVuZ3RoICYmICQoJyNwb2ludEItY29vcmQnKS52YWwoKS5sZW5ndGgpXG4gICAge1xuICAgICAgICBzZXRSb3V0ZSgpO1xuICAgIH1cbn1cbnZhciBtdWx0aVJvdXRlPWZhbHNlO1xuZnVuY3Rpb24gcmVtb3ZlUm91dGUoKSB7XG4gICAgaWYgKG11bHRpUm91dGUpIHtcbiAgICAgICAgY29udGFjdE1hcC5nZW9PYmplY3RzLnJlbW92ZShtdWx0aVJvdXRlKTtcbiAgICB9XG4gICAgbXVsdGlSb3V0ZSA9IGZhbHNlO1xufVxuZnVuY3Rpb24gc2V0Um91dGUoKVxue1xuICAgIHJlbW92ZVJvdXRlKCk7XG4gICAgdmFyIG1vZGUgPSAkKCcjcm91dGluZ01vZGUnKS52YWwoKTtcbiAgICB2YXIgYXZvaWRUcmFmZmljID0gJCgnI2F2b2lkVHJhZmZpYycpLmlzKCc6Y2hlY2tlZCcpO1xuICAgIHZhciBwb2ludEEgPSAoJCgnI3BvaW50QS1jb29yZCcpLnZhbCgpLmxlbmd0aCkgPyAkKCcjcG9pbnRBLWNvb3JkJykudmFsKCkgOiAkKCcjcG9pbnRBJykudmFsKCk7XG4gICAgdmFyIHBvaW50QiA9ICgkKCcjcG9pbnRCLWNvb3JkJykudmFsKCkubGVuZ3RoKSA/ICQoJyNwb2ludEItY29vcmQnKS52YWwoKSA6ICQoJyNwb2ludEInKS52YWwoKTtcblxuICAgIG11bHRpUm91dGUgPSBuZXcgeW1hcHMubXVsdGlSb3V0ZXIuTXVsdGlSb3V0ZSh7XG4gICAgICAgIHJlZmVyZW5jZVBvaW50czogW1xuICAgICAgICAgICAgcG9pbnRBLFxuICAgICAgICAgICAgcG9pbnRCXG4gICAgICAgIF0sXG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgcm91dGluZ01vZGU6IG1vZGUsXG4gICAgICAgICAgICBhdm9pZFRyYWZmaWNKYW1zOiBhdm9pZFRyYWZmaWNcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAgcm91dGVTdHJva2VXaWR0aDogMSxcbiAgICAgICAgcm91dGVBY3RpdmVTdHJva2VXaWR0aDogNCxcbiAgICAgICAgcm91dGVTdHJva2VDb2xvcjogXCIjZmZmZmZmXCIsXG4gICAgICAgIHJvdXRlQWN0aXZlU3Ryb2tlQ29sb3I6IFwiIzEyMmY1YlwiLFxuICAgICAgICB3YXlQb2ludFN0YXJ0SWNvbkxheW91dDogXCJkZWZhdWx0I2ltYWdlXCIsXG4gICAgICAgIHdheVBvaW50U3RhcnRJY29uSW1hZ2VIcmVmOiAnL2NvbnRlbnQvaW1hZ2VzL21hcC1tYXJrZXIucG5nJyxcbiAgICAgICAgd2F5UG9pbnRTdGFydENvbnRlbnRTaXplOiBbMTAsIDEwXSxcbiAgICAgICAgd2F5UG9pbnRTdGFydEljb25JbWFnZVNpemU6IFsyNywgMzZdLFxuICAgICAgICB3YXlQb2ludFN0YXJ0SWNvbkltYWdlT2Zmc2V0OiBbLTEzLCAtMzZdLFxuICAgICAgICB3YXlQb2ludEZpbmlzaEljb25MYXlvdXQ6IFwiZGVmYXVsdCNpbWFnZVwiLFxuICAgICAgICB3YXlQb2ludEZpbmlzaEljb25JbWFnZUhyZWY6ICcvY29udGVudC9pbWFnZXMvbWFwLW1hcmtlci5wbmcnLFxuICAgICAgICB3YXlQb2ludEZpbmlzaENvbnRlbnRTaXplOiBbMTAsIDEwXSxcbiAgICAgICAgd2F5UG9pbnRGaW5pc2hJY29uSW1hZ2VTaXplOiBbMjcsIDM2XSxcbiAgICAgICAgd2F5UG9pbnRGaW5pc2hJY29uSW1hZ2VPZmZzZXQ6IFstMTMsIC0zNl1cbiAgICB9KTtcbiAgICBjb250YWN0TWFwLmdlb09iamVjdHMuYWRkKG11bHRpUm91dGUpO1xuXG4gICAgLyp5bWFwcy5yb3V0ZShbXG4gICAgICAgICQoJyNwb2ludEEtY29vcmQnKS52YWwoKSxcbiAgICAgICAgJCgnI3BvaW50Qi1jb29yZCcpLnZhbCgpXG4gICAgXSwge1xuICAgICAgICByb3V0aW5nTW9kZTogbW9kZSxcbiAgICAgICAgYXZvaWRUcmFmZmljSmFtczogYXZvaWRUcmFmZmljLFxuICAgICAgICBtdWx0aVJvdXRlOiB0cnVlXG4gICAgfSkudGhlbihmdW5jdGlvbiAocm91dGUpIHtcbiAgICAgICAgICAgIGNvbnRhY3RNYXAuZ2VvT2JqZWN0cy5hZGQocm91dGUpO1xuICAgICAgICB9KTsqL1xufVxuXG5mdW5jdGlvbiBvcGVuUG9pbnREZXRhaWxzKG51bSkge1xuICAgIGlmICgkKCcucG9pbnQtZGV0YWlsW2RhdGEtcG9pbnQ9JytudW0rJ10nKS5pcygnOnZpc2libGUnKSlcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgcmVtb3ZlUm91dGUoKTtcbiAgICBjbG9zZUFsbFBvaW50RGV0YWlscygpO1xuICAgIC8vJCgnLnBvaW50cycpLmhpZGUoKTtcbiAgICBjbG9zZVJvdXRlKCk7XG4gICAgJCgnLnBvaW50LWRldGFpbFtkYXRhLXBvaW50PScrbnVtKyddJykuc2hvdygpO1xuXG4gICAgdmFyIG1hcmtlciA9IG1hcmtlcnNbbnVtXTtcbiAgICBtYXJrZXIuYWN0aXZlID0gdHJ1ZTtcbiAgICBtYXJrZXJzW251bV0gPSBtYXJrZXI7XG4gICAgaG92ZXJNYXJrZXIobnVtKTtcbn1cbmZ1bmN0aW9uIGNsb3NlUG9pbnREZXRhaWxzKG51bSlcbntcbiAgICAkKCcucG9pbnQtZGV0YWlsW2RhdGEtcG9pbnQ9JytudW0rJ10nKS5oaWRlKCk7XG4gICAgdmFyIG1hcmtlciA9IG1hcmtlcnNbbnVtXTtcbiAgICBtYXJrZXIuYWN0aXZlID0gZmFsc2U7XG4gICAgbWFya2Vyc1tudW1dID0gbWFya2VyO1xuICAgIGJsdXJNYXJrZXIobnVtKTtcbn1cbmZ1bmN0aW9uIGNsb3NlQWxsUG9pbnREZXRhaWxzKClcbntcbiAgICAkKCcucG9pbnQtZGV0YWlsOnZpc2libGUnKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBudW0gPSBwYXJzZUludCgkKHRoaXMpLmF0dHIoJ2RhdGEtcG9pbnQnKSk7XG4gICAgICAgIGNsb3NlUG9pbnREZXRhaWxzKG51bSk7XG4gICAgfSk7XG59XG5cbiQoZnVuY3Rpb24gKCkge1xuICAkKCcucG9pbnQtZGV0YWlsIC5jbG9zZScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcG9pbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xuICAgIHZhciBudW0gPSBwYXJzZUludChwb2ludC5hdHRyKCdkYXRhLXBvaW50JykpO1xuICAgIGNsb3NlUG9pbnREZXRhaWxzKG51bSk7XG4gICAgJCgnLnBvaW50cycpLnNob3coKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuXG4gIC8vICAgICQoJy5tYXAtcm91dGUtbGluaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gIC8vICAgICAgICAkKCcucG9pbnRzJykuaGlkZSgpO1xuICAvLyAgICAgICAgb3BlblJvdXRlKCk7XG4gIC8vICAgICAgICBjbGVhclJvdXRlcygpO1xuICAvLyAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAvLyAgICB9KTtcbiAgJCgnLnJvdXRlIC5jbG9zZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAkKCcucG9pbnRzJykuc2hvdygpO1xuICAgIGNsb3NlUm91dGUoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuXG4gICQoJy5jb250YWN0LW1hcCAucG9pbnRzIGEnKS5vbignbW91c2VlbnRlcicsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbnVtID0gcGFyc2VJbnQoJCh0aGlzKS5hdHRyKCdkYXRhLXBvaW50JykpO1xuICAgIGhvdmVyTWFya2VyKG51bSk7XG4gIH0pO1xuICAkKCcuY29udGFjdC1tYXAgLnBvaW50cyBhJykub24oJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG51bSA9IHBhcnNlSW50KCQodGhpcykuYXR0cignZGF0YS1wb2ludCcpKTtcbiAgICBibHVyTWFya2VyKG51bSk7XG4gIH0pO1xuICAkKCcuY29udGFjdC1tYXAgLnBvaW50cyBhJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIHZhciBudW0gPSBwYXJzZUludCgkKHRoaXMpLmF0dHIoJ2RhdGEtcG9pbnQnKSk7XG4gICAgLy9vcGVuUG9pbnREZXRhaWxzKG51bSk7XG4gICAgJCh0aGlzKS5uZXh0KCkuc2xpZGVUb2dnbGUoJ2Rvd24nKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuXG4gIGlmICgkKCcjY29udGFjdC1tYXAnKSAmJiAkKCcjY29udGFjdC1tYXAnKS5sZW5ndGgpIHtcbiAgICB5bWFwcy5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICBjb250YWN0TWFwID0gbmV3IHltYXBzLk1hcChcImNvbnRhY3QtbWFwXCIsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgY2VudGVyOiBbY2VudGVyX2xhdGl0dWRlLCBjZW50ZXJfbG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICAgIHpvb206IDExLFxuICAgICAgICAgICAgICAgICAgY29udHJvbHM6IFtdLFxuICAgICAgICAgICAgICAgICAgYmVoYXZpb3JzOiBbJ2RyYWcnXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgIGNvbnRhY3RNYXAuZXZlbnRzLmFkZCgnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgY29vcmRzID0gZS5nZXQoJ2Nvb3JkcycpO1xuICAgICAgICBpZiAocm91dGluZykge1xuICAgICAgICAgIHltYXBzLmdlb2NvZGUoY29vcmRzLCB7XG4gICAgICAgICAgICBraW5kOiAnaG91c2UnLFxuICAgICAgICAgICAgcmVzdWx0czogMVxuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgdmFyIGZpcnN0R2VvT2JqZWN0ID0gcmVzLmdlb09iamVjdHMuZ2V0KDApO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBmaXJzdEdlb09iamVjdC5wcm9wZXJ0aWVzLmdldCgnbmFtZScpO1xuICAgICAgICAgICAgLy92YXIgdGV4dCA9IGZpcnN0R2VvT2JqZWN0LnByb3BlcnRpZXMuZ2V0KCd0ZXh0Jyk7XG5cbiAgICAgICAgICAgIGlmICghJCgnI3BvaW50QScpLnZhbCgpLmxlbmd0aClcbiAgICAgICAgICAgICAgc2V0Um91dGVQb2ludChjb29yZHMsIG5hbWUsIDEpO1xuICAgICAgICAgICAgZWxzZSBpZiAoISQoJyNwb2ludEInKS52YWwoKS5sZW5ndGgpXG4gICAgICAgICAgICAgIHNldFJvdXRlUG9pbnQoY29vcmRzLCBuYW1lLCAyKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGZvciAodmFyIGogaW4gY29udGFjdFBvaW50cykge1xuICAgICAgICB2YXIgcG9pbnQgPSBjb250YWN0UG9pbnRzW2pdO1xuICAgICAgICB2YXIgcGxhY2VtYXJrID0gbmV3IHltYXBzLlBsYWNlbWFyayhwb2ludCwge30sIHtcbiAgICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZVdpdGhDb250ZW50JyxcbiAgICAgICAgICBpY29uSW1hZ2VIcmVmOiAnL2NvbnRlbnQvaW1hZ2VzL3NwYWNlci5wbmcnLFxuICAgICAgICAgIGljb25JbWFnZVNpemU6IFs0NCwgNDRdLFxuICAgICAgICAgIGljb25JbWFnZU9mZnNldDogWy0yMiwgLTIyXSxcbiAgICAgICAgICBpY29uQ29udGVudFNpemU6IFs0NCwgNDRdLFxuICAgICAgICAgIHBvaW50TnVtOiBqLFxuICAgICAgICAgIGljb25Db250ZW50TGF5b3V0OiB5bWFwcy50ZW1wbGF0ZUxheW91dEZhY3RvcnkuY3JlYXRlQ2xhc3MoJzxzcGFuIGNsYXNzPVwibWFya2VyXCI+JyArIGogKyAnPC9zcGFuPicpXG4gICAgICAgIH0pO1xuICAgICAgICBwbGFjZW1hcmsuZXZlbnRzXG4gICAgICAgICAgICAgICAgLmFkZCgnbW91c2VlbnRlcicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgbnVtID0gZS5nZXQoJ3RhcmdldCcpLm9wdGlvbnMuZ2V0KCdwb2ludE51bScpO1xuICAgICAgICAgICAgICAgICAgaG92ZXJNYXJrZXIobnVtKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hZGQoJ21vdXNlbGVhdmUnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgdmFyIG51bSA9IGUuZ2V0KCd0YXJnZXQnKS5vcHRpb25zLmdldCgncG9pbnROdW0nKTtcbiAgICAgICAgICAgICAgICAgIGJsdXJNYXJrZXIobnVtKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hZGQoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBudW0gPSBlLmdldCgndGFyZ2V0Jykub3B0aW9ucy5nZXQoJ3BvaW50TnVtJyk7XG4gICAgICAgICAgICAgICAgICBvcGVuUG9pbnREZXRhaWxzKG51bSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIGNvbnRhY3RNYXAuZ2VvT2JqZWN0cy5hZGQocGxhY2VtYXJrKTtcbiAgICAgICAgbWFya2Vyc1tqXSA9IHtcbiAgICAgICAgICBwbGFjZW1hcms6IHBsYWNlbWFyayxcbiAgICAgICAgICBhY3RpdmU6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgICQoJyN6b29tLWluJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgem9vbSA9IGNvbnRhY3RNYXAuZ2V0Wm9vbSgpO1xuICAgICAgICBpZiAoem9vbSA+PSAxNylcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGNvbnRhY3RNYXAuc2V0Wm9vbSh6b29tICsgMSwgeyBkdXJhdGlvbjogMjAwIH0pO1xuICAgICAgfSk7XG4gICAgICAkKCcjem9vbS1vdXQnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB6b29tID0gY29udGFjdE1hcC5nZXRab29tKCk7XG4gICAgICAgIGlmICh6b29tIDw9IDEpXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICBjb250YWN0TWFwLnNldFpvb20oem9vbSAtIDEsIHsgZHVyYXRpb246IDIwMCB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgJCgnI3BvaW50cy1jaGFuZ2UnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHBvaW50QSA9ICQoJyNwb2ludEEnKS52YWwoKTtcbiAgICB2YXIgcG9pbnRBX2Nvb3JkID0gJCgnI3BvaW50QS1jb29yZCcpLnZhbCgpO1xuICAgICQoJyNwb2ludEEnKS52YWwoJCgnI3BvaW50QicpLnZhbCgpKTtcbiAgICAkKCcjcG9pbnRBLWNvb3JkJykudmFsKCQoJyNwb2ludEItY29vcmQnKS52YWwoKSk7XG4gICAgJCgnI3BvaW50QicpLnZhbChwb2ludEEpO1xuICAgICQoJyNwb2ludEItY29vcmQnKS52YWwocG9pbnRBX2Nvb3JkKTtcblxuICAgIHNldFJvdXRlKCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcblxuICAvLyAgICAkKCcucG9pbnQtZGV0YWlsIC5jb250ZW50IC5idG4nKS5vbignY2xpY2snLCBmdW5jdGlvbigpe1xuICAvLyAgICAgICAgdmFyIHBvaW50ID0gJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKTtcbiAgLy8gICAgICAgIHZhciBudW0gPSBwYXJzZUludChwb2ludC5hdHRyKCdkYXRhLXBvaW50JykpO1xuICAvLyAgICAgICAgdmFyIGNvb3JkID0gY29udGFjdFBvaW50c1tudW1dO1xuICAvLyAgICAgICAgdmFyIG5hbWUgPSAkKCcucG9pbnQgLm5hbWUnLCBwb2ludCkudGV4dCgpO1xuXG4gIC8vICAgICAgICBjbGVhclJvdXRlcygpO1xuICAvLyAgICAgICAgc2V0Um91dGVQb2ludChjb29yZCwgbmFtZSwgMik7XG5cbiAgLy8gICAgICAgIGNsb3NlQWxsUG9pbnREZXRhaWxzKCk7XG4gIC8vICAgICAgICBvcGVuUm91dGUoKTtcbiAgLy8gICAgICAgIHJldHVybiBmYWxzZTtcbiAgLy8gICAgfSk7XG5cbiAgJCgnLnJvdXRlIC5idG4nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgc2V0Um91dGUoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuICAkKCcjcm91dGluZ01vZGUnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgIHNldFJvdXRlKCk7XG4gIH0pO1xuICAkKCcjYXZvaWRUcmFmZmljJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICBzZXRSb3V0ZSgpO1xuICB9KTtcbiAgJCgnI3BvaW50QScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgJCgnI3BvaW50QS1jb29yZCcpLnZhbCgnJyk7XG4gIH0pO1xuICAkKCcjcG9pbnRCJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAkKCcjcG9pbnRCLWNvb3JkJykudmFsKCcnKTtcbiAgfSk7XG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=